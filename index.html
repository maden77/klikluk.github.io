<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Puzzle Gambar Jigsaw</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #f4f4f4;
      padding: 20px;
    }
    canvas {
      border: 2px solid #444;
      margin-top: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Puzzle Gambar Jigsaw</h1>
  <canvas id="puzzle" width="512" height="512"></canvas>

  <script>
    const canvas = document.getElementById("puzzle");
    const ctx = canvas.getContext("2d");
    const size = 512;
    const rows = 3;
    const cols = 3;
    const pieceSize = size / rows;
    let image = new Image();
    let pieces = [];
    let selected = null;

    image.onload = () => {
      createPieces();
      shufflePieces();
      drawPieces();
    };

    image.src = 'jigsaw.png'; // Pastikan file jigsaw.png ada di folder yang sama

    function createPieces() {
      pieces = [];
      for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
          pieces.push({
            sx: x * pieceSize,
            sy: y * pieceSize,
            dx: x * pieceSize,
            dy: y * pieceSize,
          });
        }
      }
    }

    function shufflePieces() {
      for (let i = pieces.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pieces[i].dx, pieces[j].dx] = [pieces[j].dx, pieces[i].dx];
        [pieces[i].dy, pieces[j].dy] = [pieces[j].dy, pieces[i].dy];
      }
    }

    function drawPieces() {
      ctx.clearRect(0, 0, size, size);
      for (const p of pieces) {
        ctx.drawImage(image, p.sx, p.sy, pieceSize, pieceSize, p.dx, p.dy, pieceSize, pieceSize);
      }
    }

    function getClickedPiece(x, y) {
      for (let i = 0; i < pieces.length; i++) {
        const p = pieces[i];
        if (
          x >= p.dx && x < p.dx + pieceSize &&
          y >= p.dy && y < p.dy + pieceSize
        ) {
          return i;
        }
      }
      return null;
    }

    function isSolved() {
      return pieces.every(p => p.dx === p.sx && p.dy === p.sy);
    }

    canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const idx = getClickedPiece(x, y);

      if (idx === null) return;

      if (selected === null) {
        selected = idx;
      } else {
        const a = pieces[selected];
        const b = pieces[idx];

        [a.dx, b.dx] = [b.dx, a.dx];
        [a.dy, b.dy] = [b.dy, a.dy];

        selected = null;
        drawPieces();

        if (isSolved()) {
          setTimeout(() => alert("ðŸŽ‰ Selamat! Puzzle selesai!"), 100);
        }
      }
    });
  </script>
</body>
</html>
