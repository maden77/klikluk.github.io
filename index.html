<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RPG Petualangan Hutan</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #222;
      color: #eee;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    
    #game-container {
      width: 800px;
      max-width: 95%;
      background-color: #333;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      margin: 20px 0;
    }
    
    #game-screen {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
    }
    
    #map {
      background-color: #1a2f1a;
      height: 400px;
      border-radius: 5px;
      position: relative;
      overflow: hidden;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231a2f1a"/><circle cx="20" cy="30" r="5" fill="%233d5a3d"/><circle cx="50" cy="20" r="5" fill="%233d5a3d"/><circle cx="80" cy="35" r="5" fill="%233d5a3d"/><circle cx="30" cy="60" r="5" fill="%233d5a3d"/><circle cx="70" cy="55" r="5" fill="%233d5a3d"/><circle cx="40" cy="80" r="5" fill="%233d5a3d"/><circle cx="85" cy="75" r="5" fill="%233d5a3d"/></svg>');
      background-size: 100px 100px;
    }
    
    #player {
      width: 40px;
      height: 60px;
      position: absolute;
      transition: all 0.3s ease;
      z-index: 10;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="60" viewBox="0 0 40 60"><circle cx="20" cy="15" r="10" fill="%23ffdbac"/><rect x="10" y="25" width="20" height="25" fill="%23336699"/><rect x="15" y="50" width="10" height="10" fill="%23552d00"/><rect x="5" y="30" width="8" height="20" fill="%23336699"/><rect x="27" y="30" width="8" height="20" fill="%23336699"/></svg>');
      background-repeat: no-repeat;
    }
    
    .enemy {
      width: 40px;
      height: 60px;
      position: absolute;
      z-index: 5;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="60" viewBox="0 0 40 60"><circle cx="20" cy="15" r="10" fill="%23ff9999"/><rect x="10" y="25" width="20" height="25" fill="%23993333"/><rect x="15" y="50" width="10" height="10" fill="%23552d00"/><rect x="5" y="30" width="8" height="20" fill="%23993333"/><rect x="27" y="30" width="8" height="20" fill="%23993333"/></svg>');
      background-repeat: no-repeat;
    }
    
    .item {
      width: 30px;
      height: 30px;
      position: absolute;
      z-index: 3;
    }
    
    .potion {
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><rect x="10" y="5" width="10" height="5" fill="%23ff0000"/><path d="M10,10 L10,25 C10,27 20,27 20,25 L20,10 Z" fill="%23ff0000"/></svg>');
    }
    
    .mana-potion {
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><rect x="10" y="5" width="10" height="5" fill="%230066ff"/><path d="M10,10 L10,25 C10,27 20,27 20,25 L20,10 Z" fill="%230066ff"/></svg>');
    }
    
    .obstacle {
      background-color: #5a3d1a;
      position: absolute;
      z-index: 2;
      border: 2px solid #3d2a0f;
    }
    
    .tree {
      width: 50px;
      height: 80px;
      position: absolute;
      z-index: 2;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="50" height="80" viewBox="0 0 50 80"><rect x="20" y="50" width="10" height="30" fill="%235a3d1a"/><circle cx="25" cy="30" r="20" fill="%231a5a1a"/></svg>');
    }
    
    .rock {
      width: 40px;
      height: 30px;
      position: absolute;
      z-index: 2;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="30" viewBox="0 0 40 30"><ellipse cx="20" cy="15" rx="18" ry="12" fill="%23666666"/></svg>');
    }
    
    #stats {
      background-color: #2a3d2a;
      padding: 15px;
      border-radius: 5px;
      border: 2px solid #1a2f1a;
    }
    
    .stat-bar {
      height: 20px;
      background-color: #1a2f1a;
      border-radius: 10px;
      margin-bottom: 10px;
      overflow: hidden;
    }
    
    .stat-fill {
      height: 100%;
      border-radius: 10px;
    }
    
    #health .stat-fill {
      background-color: #ff3333;
      width: 100%;
    }
    
    #mana .stat-fill {
      background-color: #3399ff;
      width: 80%;
    }
    
    #exp .stat-fill {
      background-color: #ffcc00;
      width: 30%;
    }
    
    #inventory {
      margin-top: 20px;
      background-color: #2a3d2a;
      padding: 10px;
      border-radius: 5px;
      border: 2px solid #1a2f1a;
    }
    
    #inventory-items {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .inventory-item {
      width: 40px;
      height: 40px;
      background-color: #1a2f1a;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 1px solid #3d5a3d;
    }
    
    #controls {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    
    button {
      padding: 10px;
      background-color: #3d5a3d;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
      font-weight: bold;
      border: 1px solid #1a2f1a;
    }
    
    button:hover {
      background-color: #2a3d2a;
    }
    
    #action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    #action-buttons button {
      flex: 1;
    }
    
    #attack {
      background-color: #993333;
    }
    
    #attack:hover {
      background-color: #802020;
    }
    
    #use-item {
      background-color: #ffcc00;
      color: #333;
    }
    
    #use-item:hover {
      background-color: #e6b800;
    }
    
    #message-log {
      margin-top: 20px;
      height: 100px;
      overflow-y: auto;
      background-color: #1a2f1a;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #3d5a3d;
    }
    
    .message {
      margin: 5px 0;
      padding: 5px;
      border-radius: 3px;
    }
    
    .info {
      background-color: rgba(51, 153, 255, 0.2);
    }
    
    .damage {
      background-color: rgba(255, 51, 51, 0.2);
    }
    
    .heal {
      background-color: rgba(51, 204, 51, 0.2);
    }
    
    #game-over {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }
    
    #game-over h2 {
      color: #ff3333;
      font-size: 3em;
      margin-bottom: 20px;
    }
    
    @media (max-width: 600px) {
      #game-screen {
        grid-template-columns: 1fr;
      }
      
      #map {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <h1>Petualangan di Hutan</h1>
  
  <div id="game-container">
    <div id="game-screen">
      <div id="map">
        <div id="player"></div>
        <!-- Musuh dan item akan ditambahkan secara dinamis -->
      </div>
      
      <div id="stats">
        <h2>Status</h2>
        <div>
          <h3>Petualang</h3>
          <p>Level: <span id="player-level">1</span></p>
          
          <div class="stat-bar" id="health">
            <div class="stat-fill" id="health-fill"></div>
          </div>
          <p>HP: <span id="hp-text">100/100</span></p>
          
          <div class="stat-bar" id="mana">
            <div class="stat-fill" id="mana-fill"></div>
          </div>
          <p>Mana: <span id="mana-text">50/50</span></p>
          
          <div class="stat-bar" id="exp">
            <div class="stat-fill" id="exp-fill"></div>
          </div>
          <p>EXP: <span id="exp-text">0/100</span></p>
        </div>
        
        <div id="inventory">
          <h3>Inventory</h3>
          <div id="inventory-items">
            <!-- Item akan ditambahkan secara dinamis -->
          </div>
        </div>
      </div>
    </div>
    
    <div id="controls">
      <button id="up">↑</button>
      <button id="left">←</button>
      <button id="right">→</button>
      <button id="down">↓</button>
      <button id="wait">Tunggu</button>
      <button id="rest">Istirahat</button>
    </div>
    
    <div id="action-buttons">
      <button id="attack">Serang</button>
      <button id="use-item">Gunakan Item</button>
    </div>
    
    <div id="message-log">
      <div class="message info">Selamat datang di Petualangan Hutan!</div>
      <div class="message info">Gunakan tombol arah untuk bergerak.</div>
    </div>
  </div>
  
  <div id="game-over">
    <h2>GAME OVER</h2>
    <button id="restart">Main Lagi</button>
  </div>
  
  <script>
    // Game state
    const gameState = {
      player: {
        x: 100,
        y: 100,
        maxHp: 100,
        hp: 100,
        maxMana: 50,
        mana: 50,
        attack: 10,
        defense: 5,
        level: 1,
        exp: 0,
        nextLevelExp: 100,
        inventory: [
          { id: 'potion', name: 'Potion', effect: { hp: 20 }, quantity: 3 },
          { id: 'mana-potion', name: 'Mana Potion', effect: { mana: 15 }, quantity: 2 }
        ]
      },
      enemies: [],
      items: [],
      obstacles: [],
      trees: [],
      rocks: [],
      gameOver: false,
      currentEnemy: null,
      messages: [
        { text: 'Selamat datang di Petualangan Hutan!', type: 'info' },
        { text: 'Gunakan tombol arah untuk bergerak.', type: 'info' }
      ]
    };

    // DOM elements
    const playerElement = document.getElementById('player');
    const mapElement = document.getElementById('map');
    const hpText = document.getElementById('hp-text');
    const manaText = document.getElementById('mana-text');
    const expText = document.getElementById('exp-text');
    const playerLevel = document.getElementById('player-level');
    const healthFill = document.getElementById('health-fill');
    const manaFill = document.getElementById('mana-fill');
    const expFill = document.getElementById('exp-fill');
    const inventoryItems = document.getElementById('inventory-items');
    const messageLog = document.getElementById('message-log');
    const gameOverScreen = document.getElementById('game-over');
    const restartButton = document.getElementById('restart');

    // Initialize game
    function initGame() {
      // Reset player position
      gameState.player.x = 100;
      gameState.player.y = 100;
      gameState.player.hp = gameState.player.maxHp;
      gameState.player.mana = gameState.player.maxMana;
      gameState.gameOver = false;
      gameState.currentEnemy = null;
      
      // Clear existing elements
      gameState.enemies = [];
      gameState.items = [];
      gameState.obstacles = [];
      gameState.trees = [];
      gameState.rocks = [];
      
      document.querySelectorAll('.enemy, .item, .obstacle, .tree, .rock').forEach(el => el.remove());
      
      // Create environment
      createEnvironment();
      
      // Create enemies
      for (let i = 0; i < 5; i++) {
        createEnemy();
      }
      
      // Create items
      for (let i = 0; i < 3; i++) {
        createItem('potion');
      }
      for (let i = 0; i < 2; i++) {
        createItem('mana-potion');
      }
      
      // Update UI
      updatePlayerPosition();
      updateStats();
      updateInventory();
      
      // Hide game over screen
      gameOverScreen.style.display = 'none';
      
      // Add initial messages
      addMessage('Petualangan baru dimulai di hutan yang lebat!', 'info');
    }

    // Create environment
    function createEnvironment() {
      const mapWidth = mapElement.offsetWidth;
      const mapHeight = mapElement.offsetHeight;
      
      // Create border obstacles
      gameState.obstacles.push({ x: 0, y: 0, width: mapWidth, height: 20 });
      gameState.obstacles.push({ x: 0, y: mapHeight - 20, width: mapWidth, height: 20 });
      gameState.obstacles.push({ x: 0, y: 0, width: 20, height: mapHeight });
      gameState.obstacles.push({ x: mapWidth - 20, y: 0, width: 20, height: mapHeight });
      
      // Create trees
      for (let i = 0; i < 15; i++) {
        const tree = {
          x: Math.random() * (mapWidth - 60) + 10,
          y: Math.random() * (mapHeight - 100) + 10,
          width: 50,
          height: 80
        };
        
        // Pastikan tidak spawn di dekat player
        if (Math.abs(tree.x - gameState.player.x) > 100 || Math.abs(tree.y - gameState.player.y) > 100) {
          gameState.trees.push(tree);
          gameState.obstacles.push(tree); // Tree juga sebagai obstacle
        }
      }
      
      // Create rocks
      for (let i = 0; i < 10; i++) {
        const rock = {
          x: Math.random() * (mapWidth - 50) + 10,
          y: Math.random() * (mapHeight - 40) + 10,
          width: 40,
          height: 30
        };
        
        if (Math.abs(rock.x - gameState.player.x) > 100 || Math.abs(rock.y - gameState.player.y) > 100) {
          gameState.rocks.push(rock);
          gameState.obstacles.push(rock);
        }
      }
      
      // Render environment
      renderEnvironment();
    }

    // Render environment
    function renderEnvironment() {
      // Render trees
      gameState.trees.forEach(tree => {
        const treeElement = document.createElement('div');
        treeElement.className = 'tree';
        treeElement.style.left = `${tree.x}px`;
        treeElement.style.top = `${tree.y}px`;
        mapElement.appendChild(treeElement);
      });
      
      // Render rocks
      gameState.rocks.forEach(rock => {
        const rockElement = document.createElement('div');
        rockElement.className = 'rock';
        rockElement.style.left = `${rock.x}px`;
        rockElement.style.top = `${rock.y}px`;
        mapElement.appendChild(rockElement);
      });
    }

    // Create enemy
    function createEnemy() {
      const mapWidth = mapElement.offsetWidth;
      const mapHeight = mapElement.offsetHeight;
      
      // Pastikan musuh tidak muncul di dekat player
      let x, y;
      do {
        x = Math.random() * (mapWidth - 60) + 20;
        y = Math.random() * (mapHeight - 80) + 20;
      } while (Math.abs(x - gameState.player.x) < 100 && Math.abs(y - gameState.player.y) < 100);
      
      const level = Math.floor(Math.random() * 3) + 1;
      const maxHp = 20 + (level - 1) * 10;
      
      const enemy = {
        id: `enemy-${Date.now()}-${Math.floor(Math.random() * 1000)}`,
        x,
        y,
        maxHp,
        hp: maxHp,
        attack: 5 + (level - 1) * 2,
        defense: 2 + (level - 1),
        level,
        exp: 10 * level
      };
      
      gameState.enemies.push(enemy);
      renderEnemy(enemy);
    }

    // Render enemy
    function renderEnemy(enemy) {
      const enemyElement = document.createElement('div');
      enemyElement.className = 'enemy';
      enemyElement.id = enemy.id;
      enemyElement.style.left = `${enemy.x}px`;
      enemyElement.style.top = `${enemy.y}px`;
      enemyElement.title = `Musuh Level ${enemy.level}\nHP: ${enemy.hp}/${enemy.maxHp}`;
      mapElement.appendChild(enemyElement);
    }

    // Create item
    function createItem(type) {
      const mapWidth = mapElement.offsetWidth;
      const mapHeight = mapElement.offsetHeight;
      
      const x = Math.random() * (mapWidth - 40) + 20;
      const y = Math.random() * (mapHeight - 40) + 20;
      
      const item = {
        id: `item-${Date.now()}-${Math.floor(Math.random() * 1000)}`,
        x,
        y,
        type
      };
      
      gameState.items.push(item);
      renderItem(item);
    }

    // Render item
    function renderItem(item) {
      const itemElement = document.createElement('div');
      itemElement.className = `item ${item.type}`;
      itemElement.id = item.id;
      itemElement.style.left = `${item.x}px`;
      itemElement.style.top = `${item.y}px`;
      
      if (item.type === 'potion') {
        itemElement.title = 'Potion (Restore 20 HP)';
      } else if (item.type === 'mana-potion') {
        itemElement.title = 'Mana Potion (Restore 15 Mana)';
      }
      
      mapElement.appendChild(itemElement);
    }

    // Update player position on screen
    function updatePlayerPosition() {
      playerElement.style.left = `${gameState.player.x}px`;
      playerElement.style.top = `${gameState.player.y}px`;
      
      // Cek collision dengan musuh
      checkEnemyCollision();
      
      // Cek collision dengan item
      checkItemCollision();
    }

    // Check enemy collision
    function checkEnemyCollision() {
      const playerWidth = 40;
      const playerHeight = 60;
      const enemyWidth = 40;
      const enemyHeight = 60;
      
      for (let i = 0; i < gameState.enemies.length; i++) {
        const enemy = gameState.enemies[i];
        
        if (
          gameState.player.x < enemy.x + enemyWidth &&
          gameState.player.x + playerWidth > enemy.x &&
          gameState.player.y < enemy.y + enemyHeight &&
          gameState.player.y + playerHeight > enemy.y
        ) {
          // Player bertemu musuh
          gameState.currentEnemy = enemy;
          addMessage(`Anda bertemu musuh level ${enemy.level}!`, 'info');
          return;
        }
      }
      
      // Tidak ada musuh yang bertemu
      gameState.currentEnemy = null;
    }

    // Check item collision
    function checkItemCollision() {
      const playerWidth = 40;
      const playerHeight = 60;
      const itemSize = 30;
      
      for (let i = 0; i < gameState.items.length; i++) {
        const item = gameState.items[i];
        
        if (
          gameState.player.x < item.x + itemSize &&
          gameState.player.x + playerWidth > item.x &&
          gameState.player.y < item.y + itemSize &&
          gameState.player.y + playerHeight > item.y
        ) {
          // Player mengambil item
          pickUpItem(item);
          return;
        }
      }
    }

    // Pick up item
    function pickUpItem(item) {
      // Hapus item dari map
      document.getElementById(item.id)?.remove();
      gameState.items = gameState.items.filter(i => i.id !== item.id);
      
      // Tambahkan ke inventory
      const existingItem = gameState.player.inventory.find(i => i.id === item.type);
      if (existingItem) {
        existingItem.quantity++;
      } else {
        if (item.type === 'potion') {
          gameState.player.inventory.push({ 
            id: 'potion', 
            name: 'Potion', 
            effect: { hp: 20 }, 
            quantity: 1 
          });
        } else if (item.type === 'mana-potion') {
          gameState.player.inventory.push({ 
            id: 'mana-potion', 
            name: 'Mana Potion', 
            effect: { mana: 15 }, 
            quantity: 1 
          });
        }
      }
      
      addMessage(`Anda mendapatkan ${item.type === 'potion' ? 'Potion' : 'Mana Potion'}!`, 'info');
      updateInventory();
    }

    // Update player stats display
    function updateStats() {
      // Update HP
      const hpPercent = (gameState.player.hp / gameState.player.maxHp) * 100;
      healthFill.style.width = `${hpPercent}%`;
      hpText.textContent = `${gameState.player.hp}/${gameState.player.maxHp}`;
      
      // Update Mana
      const manaPercent = (gameState.player.mana / gameState.player.maxMana) * 100;
      manaFill.style.width = `${manaPercent}%`;
      manaText.textContent = `${gameState.player.mana}/${gameState.player.maxMana}`;
      
      // Update EXP
    
